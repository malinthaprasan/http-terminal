<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HTTP Terminal</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: #0d0d0d;
      color: #f0f0f0;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .toolbar {
      background: #2d2d2d;
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 10px;
      border-bottom: 1px solid #444;
    }
    .toolbar label {
      color: #888;
      font-size: 13px;
    }
    .toolbar input {
      background: #1a1a1a;
      border: 1px solid #444;
      color: #f0f0f0;
      padding: 6px 10px;
      font-family: inherit;
      font-size: 13px;
      border-radius: 3px;
      width: 300px;
    }
    .terminal {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      cursor: text;
    }
    .line {
      white-space: pre-wrap;
      word-wrap: break-word;
      line-height: 1.5;
    }
    .output {
      color: #e0e0e0;
    }
    .error {
      color: #ef5350;
    }
    .system {
      color: #888;
      font-style: italic;
    }
    .input-line {
      display: flex;
      line-height: 1.5;
    }
    .prompt {
      color: #4caf50;
      user-select: none;
    }
    .input-line input {
      flex: 1;
      background: transparent;
      border: none;
      color: #64b5f6;
      font-family: inherit;
      font-size: 14px;
      outline: none;
      padding: 0;
      margin: 0;
    }
    .input-line input:disabled {
      color: #555;
    }
    .command-text {
      color: #64b5f6;
    }
  </style>
</head>
<body>
  <div class="toolbar">
    <label>Server:</label>
    <input type="text" id="serverUrl" value="http://localhost:8080" placeholder="Server URL">
  </div>

  <div id="terminal" class="terminal">
    <div id="inputLine" class="input-line">
      <span class="prompt">$ </span>
      <input type="text" id="cmdInput" placeholder="" autofocus>
    </div>
  </div>

  <script>
    const serverUrlInput = document.getElementById('serverUrl');
    const terminal = document.getElementById('terminal');
    const cmdInput = document.getElementById('cmdInput');
    const inputLine = document.getElementById('inputLine');

    function addOutput(text, type = 'output') {
      const div = document.createElement('div');
      div.className = `line ${type}`;
      div.textContent = text;
      terminal.insertBefore(div, inputLine);
      terminal.scrollTop = terminal.scrollHeight;
    }

    function addCommand(cmd) {
      const div = document.createElement('div');
      div.className = 'line';
      div.innerHTML = '<span class="prompt">$ </span><span class="command-text"></span>';
      div.querySelector('.command-text').textContent = cmd;
      terminal.insertBefore(div, inputLine);
    }

    async function sendCommand() {
      const cmd = cmdInput.value;
      if (!cmd) return;

      addCommand(cmd);
      cmdInput.value = '';
      cmdInput.disabled = true;

      try {
        const res = await fetch(`${serverUrlInput.value}/exec`, {
          method: 'POST',
          body: cmd
        });
        const output = await res.text();
        output.split('\n').forEach(line => {
          addOutput(line, 'output');
        });
      } catch (err) {
        addOutput(`Error: ${err.message}`, 'error');
      }

      cmdInput.disabled = false;
      cmdInput.focus();
      terminal.scrollTop = terminal.scrollHeight;
    }

    cmdInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        sendCommand();
      }
    });

    terminal.addEventListener('click', () => {
      cmdInput.focus();
    });
  </script>
</body>
</html>
